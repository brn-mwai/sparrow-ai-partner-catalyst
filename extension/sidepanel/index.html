<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sparrow AI Brief</title>
  <link rel="icon" type="image/png" href="../assets/favicon.png">
  <link rel="stylesheet" href="../assets/brand.css">
  <link rel="stylesheet" href="styles.css">
  <script src="https://unpkg.com/@rive-app/canvas@2.21.6"></script>
</head>
<body>
  <div class="sidepanel">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <img src="../assets/logo-mark.svg" alt="" class="logo-mark">
        <span class="logo-text">Sparrow AI</span>
      </div>
      <div class="header-actions">
        <button class="icon-btn" id="refreshBtn" title="Refresh brief">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 4v6h-6"/><path d="M1 20v-6h6"/>
            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
          </svg>
        </button>
        <button class="icon-btn" id="openDashboardBtn" title="Open Dashboard">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
            <polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Loading State -->
    <div class="state-container" id="loadingState">
      <div class="sage-orb-container">
        <canvas id="loadingOrb" class="sage-orb-canvas"></canvas>
      </div>
      <p class="state-text">Generating your brief...</p>
    </div>

    <!-- Auth State -->
    <div class="state-container hidden" id="authState">
      <div class="auth-visual">
        <img src="../assets/logo-mark.svg" alt="" class="auth-logo">
      </div>
      <h2 class="state-title">Sign in to Sparrow AI</h2>
      <p class="state-text">Connect your account to generate briefs</p>
      <button class="btn btn-primary" id="signInBtn">Sign In</button>
    </div>

    <!-- Empty State -->
    <div class="state-container hidden" id="emptyState">
      <div class="empty-visual">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--gray-300)" stroke-width="1.5">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
      </div>
      <h2 class="state-title">No Brief Yet</h2>
      <p class="state-text">Click the Sparrow AI button on a LinkedIn profile to generate a brief</p>
    </div>

    <!-- Error State -->
    <div class="state-container hidden" id="errorState">
      <div class="error-visual">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--error-500)" stroke-width="1.5">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
      </div>
      <h2 class="state-title">Something went wrong</h2>
      <p class="state-text" id="errorMessage">Failed to generate brief</p>
      <button class="btn btn-primary" id="retryBtn">Try Again</button>
    </div>

    <!-- Brief Content -->
    <div class="brief-content hidden" id="briefContent">
      <!-- Profile Header -->
      <div class="profile-header">
        <img class="profile-photo" id="profilePhoto" src="" alt="">
        <div class="profile-info">
          <h1 class="profile-name" id="profileName"></h1>
          <p class="profile-headline" id="profileHeadline"></p>
          <p class="profile-meta">
            <span id="profileLocation"></span>
            <span class="separator"></span>
            <span id="profileCompany"></span>
          </p>
        </div>
      </div>

      <!-- Meeting Goal -->
      <div class="goal-section">
        <label class="goal-label">Meeting goal:</label>
        <div class="goal-selector" id="goalSelector">
          <button class="goal-btn active" data-goal="networking">Network</button>
          <button class="goal-btn" data-goal="sales">Sales</button>
          <button class="goal-btn" data-goal="hiring">Hiring</button>
          <button class="goal-btn" data-goal="investor">Investor</button>
          <button class="goal-btn goal-btn-custom" data-goal="custom" id="customGoalBtn">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Custom
          </button>
        </div>
        <!-- Custom Goal Input -->
        <div class="custom-goal-input hidden" id="customGoalInput">
          <input type="text" id="customGoalText" placeholder="e.g., Partnership discussion, Mentorship..." maxlength="100">
          <div class="custom-goal-actions">
            <button class="btn btn-sm btn-secondary" id="cancelCustomGoal">Cancel</button>
            <button class="btn btn-sm btn-primary" id="applyCustomGoal">Apply</button>
          </div>
        </div>
      </div>

      <!-- Brief Sections -->
      <div class="brief-sections">
        <!-- Summary -->
        <section class="brief-section">
          <div class="section-header">
            <div class="section-title-wrap">
              <svg class="section-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
              </svg>
              <h2 class="section-title">Summary</h2>
            </div>
            <button class="copy-btn" data-section="summary" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
            </button>
          </div>
          <p class="section-content" id="summaryContent"></p>
        </section>

        <!-- Talking Points -->
        <section class="brief-section">
          <div class="section-header">
            <div class="section-title-wrap">
              <svg class="section-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
              </svg>
              <h2 class="section-title">Talking Points</h2>
            </div>
            <button class="copy-btn" data-section="talkingPoints" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
            </button>
          </div>
          <ul class="section-list" id="talkingPointsList"></ul>
        </section>

        <!-- Common Ground -->
        <section class="brief-section">
          <div class="section-header">
            <div class="section-title-wrap">
              <svg class="section-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              </svg>
              <h2 class="section-title">Common Ground</h2>
            </div>
            <button class="copy-btn" data-section="commonGround" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
            </button>
          </div>
          <ul class="section-list" id="commonGroundList"></ul>
        </section>

        <!-- Icebreaker -->
        <section class="brief-section">
          <div class="section-header">
            <div class="section-title-wrap">
              <svg class="section-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
              </svg>
              <h2 class="section-title">Icebreaker</h2>
            </div>
            <button class="copy-btn" data-section="icebreaker" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
            </button>
          </div>
          <div class="icebreaker-box" id="icebreakerContent"></div>
        </section>

        <!-- Questions -->
        <section class="brief-section">
          <div class="section-header">
            <div class="section-title-wrap">
              <svg class="section-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <line x1="12" y1="17" x2="12.01" y2="17"/>
              </svg>
              <h2 class="section-title">Questions to Ask</h2>
            </div>
            <button class="copy-btn" data-section="questions" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
            </button>
          </div>
          <ul class="section-list" id="questionsList"></ul>
        </section>
      </div>

      <!-- Sage AI Section -->
      <div class="sage-section">
        <div class="sage-header">
          <canvas id="sageOrb" class="sage-orb-canvas-small"></canvas>
          <span class="sage-title">Ask Sage</span>
        </div>
        <p class="sage-description">Get deeper insights about this person</p>
        <button class="btn btn-secondary btn-full" id="openSageBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
          </svg>
          Chat with Sage AI
        </button>
      </div>

      <!-- Footer Actions -->
      <div class="brief-footer">
        <button class="btn btn-secondary" id="copyAllBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
          </svg>
          Copy All
        </button>
        <button class="btn btn-primary" id="saveBtn">
          <svg id="saveIcon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
          </svg>
          <span id="saveText">Save</span>
        </button>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast hidden" id="toast">
      <span id="toastMessage">Copied to clipboard!</span>
    </div>
  </div>

  <script src="sidepanel.js" type="module"></script>
</body>
</html>
